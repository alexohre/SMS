<div class="row">
	<!-- Content Column -->
	<div class="col-lg-6 mb-4 mx-auto">
		<!-- Project Card Example -->
		<div class="card shadow mb-4">
			<div class="card-header py-3">
				<h6 class="m-0 font-weight-bold text-primary">Ticket Form</h6>
			</div>
			<div class="card-body">
				<%= form_with(model: [:admin, ticket]) do |form| %>
					<% if ticket.errors.any? %>
						<div style="color: red">
							<h2><%= pluralize(ticket.errors.count, "error") %> prohibited this ticket from being saved:</h2>
							<ul>
								<% ticket.errors.each do |error| %>
									<li><%= error.full_message %></li>
								<% end %>
							</ul>
						</div>
					<% end %>
					<div class="form-group">
						<%= form.label :event_id, "Select Event" %> <span style="color:red; font-size:20px">*</span>
						<%= form.collection_select(:event_id, @events, :id, :name, { prompt: true }, { class: "form-control" }) %>
					</div>
					<div class="form-group">
						<%= form.hidden_field :name, class: "form-control", placeholder: "Ticket name", disabled: true %>
					</div>
					<div class="form-row">
						<div class="col">
							<div class="form-group">
								<%= form.label :ticket_type %> <span style="color:red; font-size:20px">*</span>
								<%= form.select :ticket_type, Ticket.ticket_types.keys.map { |type| [type.titleize, type] }, { prompt: true, required: true }, class: "form-control", id: "ticket_ticket_type" %>
							</div>
						</div>
						<div class="col">
							<div class="form-group" id="default">
								<%= form.label :default %>
								<%= form.text_field :default_seats, class: "form-control", placeholder: "Default", disabled: true %>
							</div>
							<div class="form-group" id="regular-seats">
								<%= form.label :regular_seats, "No. of Regular seats" %> <span style="color:red; font-size:20px">*</span>
								<%= form.number_field :regular_seats, class: "form-control", placeholder: "Ex: 30,000" %>
							</div>
							<div class="form-group" id="vip-seats">
								<%= form.label :vip_seats, "No. of VIP seats" %> <span style="color:red; font-size:20px">*</span>
								<%= form.number_field :vip_seats, class: "form-control", placeholder: "Ex: 10,000" %>
							</div>
						</div>
					</div>
					<div class="form-group">
						<%= form.label :price %> <span style="color:red; font-size:20px">*</span>
						<%#= form.number_field :price, class: "form-control", step: "0.01", placeholder: "Price", value: number_with_precision(@ticket.price, precision: 2) %>
						<%= form.number_field :price, class: "form-control", step: "0.01", placeholder: "Ticket price", required: false %>
					</div>
					<div class="form-group">
						<%= form.submit class: "btn btn-primary" %>
					</div>
				<% end %>
			</div>
		</div>
	</div>
</div>
<script>
	document.addEventListener("turbo:load", function() {
	  const defaultField = document.getElementById("default");
	  const vipSeatsField = document.getElementById("vip-seats");
	  const regularSeatsField = document.getElementById("regular-seats");
	  const ticketTypeField = document.getElementById("ticket_ticket_type");

	  function toggleFields() {
	    if (ticketTypeField.value === "VIP") {
	      vipSeatsField.style.display = "block";
	      regularSeatsField.style.display = "none";
	      defaultField.style.display = "none";
	      vipSeatsField.querySelector('input').required = true;
	      regularSeatsField.querySelector('input').required = false;
	      defaultField.querySelector('input').required = false;
	    } else if (ticketTypeField.value === "Regular") {
	      vipSeatsField.style.display = "none";
	      regularSeatsField.style.display = "block";
	      defaultField.style.display = "none";
	      vipSeatsField.querySelector('input').required = false;
	      regularSeatsField.querySelector('input').required = true;
	      defaultField.querySelector('input').required = false;
	    } else {
	      vipSeatsField.style.display = "none";
	      regularSeatsField.style.display = "none";
	      defaultField.style.display = "block";
	      vipSeatsField.querySelector('input').required = false;
	      regularSeatsField.querySelector('input').required = false;
	      defaultField.querySelector('input').required = true;
	    }
	  }

	  toggleFields();

	  ticketTypeField.addEventListener("change", function() {
	    toggleFields();
	  });


	  document.addEventListener("turbo:submit-start", function() {
			toggleFields();
	  });

		document.addEventListener("turbo:load", function() {
			toggleFields();
		});
	});
</script>
